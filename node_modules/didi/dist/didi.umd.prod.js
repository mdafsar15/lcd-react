!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).Didi={})}(this,(function(n){"use strict";var t=/^class /;function e(n){return"[object Array]"===Object.prototype.toString.call(n)}function r(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function i(){var n=Array.prototype.slice.call(arguments);1===n.length&&e(n[0])&&(n=n[0]);var t=n.pop();return t.$inject=n,t}var o=/constructor\s*[^(]*\(\s*([^)]*)\)/m,c=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,u=/\/\*([^*]*)\*\//m;function f(n){if("function"!=typeof n)throw new Error('Cannot annotate "'+n+'". Expected a function!');var e=n.toString().match(function(n){return t.test(n.toString())}(n)?o:c);if(!e)return[];var r=e[1]||e[2];return r&&r.split(",").map((function(n){var t=n.match(u);return(t&&t[1]||n).trim()}))||[]}function a(n,t){return"value"!==n&&e(t)&&(t=i(t.slice())),t}n.Injector=function n(t,o){o=o||{get:function(n,t){if(c.push(n),!1===t)return null;throw l('No provider for "'+n+'"!')}};var c=[],u=this._providers=Object.create(o._providers||null),s=this._instances=Object.create(null),p=s.injector=this,l=function(n){var t=c.join(" -> ");return c.length=0,new Error(t?n+" (Resolving: "+t+")":n)};function d(n,t){if(!u[n]&&-1!==n.indexOf(".")){for(var e=n.split("."),i=d(e.shift());e.length;)i=i[e.shift()];return i}if(r(s,n))return s[n];if(r(u,n)){if(-1!==c.indexOf(n))throw c.push(n),l("Cannot resolve circular dependency!");return c.push(n),s[n]=u[n][0](u[n][1]),c.pop(),s[n]}return o.get(n,t)}function _(n,t){if(void 0===t&&(t={}),"function"!=typeof n){if(!e(n))throw new Error('Cannot invoke "'+n+'". Expected a function!');n=i(n.slice())}return{fn:n,dependencies:(n.$inject||f(n)).map((function(n){return r(t,n)?t[n]:d(n)}))}}function h(n){var t=_(n),e=t.fn,r=t.dependencies;return new(Function.prototype.bind.apply(e,[null].concat(r)))}function v(n,t,e){var r=_(n,e),i=r.fn,o=r.dependencies;return i.apply(t,o)}function y(n){return i((function(t){return n.get(t)}))}function g(t,e){if(e&&e.length){var r,i,o,c,f=Object.create(null),a=Object.create(null),s=[],l=[],d=[];for(var _ in u)r=u[_],-1!==e.indexOf(_)&&("private"===r[2]?-1===(i=s.indexOf(r[3]))?(c=y(o=r[3].createChild([],e)),s.push(r[3]),l.push(o),d.push(c),f[_]=[c,_,"private",o]):f[_]=[d[i],_,"private",l[i]]:f[_]=[r[2],r[1]],a[_]=!0),"factory"!==r[2]&&"type"!==r[2]||!r[1].$scope||e.forEach((function(n){-1!==r[1].$scope.indexOf(n)&&(f[_]=[r[2],r[1]],a[n]=!0)}));e.forEach((function(n){if(!a[n])throw new Error('No provider for "'+n+'". Cannot use provider from the parent!')})),t.unshift(f)}return new n(t,p)}var O,j,w={factory:v,type:h,value:function(n){return n}};function b(n,t){var e=n.__init__||[];return function(){e.forEach((function(n){try{"string"==typeof n?t.get(n):t.invoke(n)}catch(n){if("undefined"!=typeof AggregateError)throw new AggregateError([n],"Failed to initialize!");throw new Error("Failed to initialize! "+n.message)}}))}}function m(n){var t=n.__exports__;if(t){var e=n.__modules__,r=Object.keys(n).reduce((function(t,e){return"__exports__"!==e&&"__modules__"!==e&&"__init__"!==e&&"__depends__"!==e&&(t[e]=n[e]),t}),Object.create(null)),o=g((e||[]).concat(r)),c=i((function(n){return o.get(n)}));t.forEach((function(n){u[n]=[c,n,"private",o]}));var f=(n.__init__||[]).slice();return f.unshift((function(){o.init()})),b(n=Object.assign({},n,{__init__:f}),o)}return Object.keys(n).forEach((function(t){if("__init__"!==t&&"__depends__"!==t)if("private"!==n[t][2]){var e=n[t][0],r=n[t][1];u[t]=[w[e],a(e,r),e]}else u[t]=n[t]})),b(n,p)}function E(n,t){return-1!==n.indexOf(t)||-1!==(n=(t.__depends__||[]).reduce(E,n)).indexOf(t)?n:n.concat(t)}this.get=d,this.invoke=v,this.instantiate=h,this.createChild=g,this.init=(O=t.reduce(E,[]).map(m),j=!1,function(){j||(j=!0,O.forEach((function(n){return n()})))})},n.annotate=i,n.parseAnnotations=f,Object.defineProperty(n,"__esModule",{value:!0})}));
